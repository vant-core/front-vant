{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Acer/Desktop/Vant/front-vant/services/api.ts"],"sourcesContent":["import axios from 'axios';\nimport {\n  ChatMessageDTO,\n  ChatApiResponse,\n  LoginDTO,\n  RegisterDTO,\n  EventRegistrationDTO,\n  Folder,\n  FolderItem,\n  FolderWithCount,\n  WorkspaceStats,\n  CreateFolderPathDTO,\n  CreateSubfolderDTO,\n  AddItemToFolderPathDTO,\n  AddItemToPathDTO,\n  SearchItemsDTO,\n  GenerateReportDTO,\n  ReportPreviewResponse,\n  GenerateReportFromHTMLDTO\n} from '../types/index';\n\nconst isLocalhost =\n  typeof window !== 'undefined' &&\n  (window.location.hostname === 'localhost' ||\n   window.location.hostname === '127.0.0.1');\n\nconst apiBaseURL = isLocalhost\n  ? 'http://localhost:3000'\n  : 'https://back-end-ypsc.onrender.com';\n\nconst api = axios.create({\n  baseURL: apiBaseURL,\n  withCredentials: true,\n});\n\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers = config.headers || {};\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n/* ---------------------------------------------------------\n   AUTH\n--------------------------------------------------------- */\nexport const login = async (payload: LoginDTO) => {\n  const { data } = await api.post('/api/auth/login', payload);\n  return data;\n};\n\nexport const register = async (payload: RegisterDTO) => {\n  const { data } = await api.post('/api/auth/register', payload);\n  return data;\n};\n\n/* ---------------------------------------------------------\n   CHAT\n--------------------------------------------------------- */\nexport const chatWithAI = async (\n  payload: ChatMessageDTO\n): Promise<ChatApiResponse> => {\n  const { data } = await api.post<ChatApiResponse>('/api/ai/chat', payload);\n  return data;\n};\n\n/* ---------------------------------------------------------\n   EVENT REGISTRATION\n--------------------------------------------------------- */\nexport const saveEventRegistration = async (\n  payload: EventRegistrationDTO\n) => {\n  const { data } = await api.post('/api/events/registration', payload);\n  return data;\n};\n\n/* ---------------------------------------------------------\n   FILES\n--------------------------------------------------------- */\nexport const downloadFile = async (fileName: string): Promise<Blob> => {\n  const response = await api.get(`/api/files/download/${fileName}`, {\n    responseType: 'blob'\n  });\n  return response.data;\n};\n\n/* ---------------------------------------------------------\n   WORKSPACE (Hier√°rquico Profundo)\n--------------------------------------------------------- */\n\nexport const getFolders = async (): Promise<FolderWithCount[]> => {\n  const { data } = await api.get('/api/workspace/folders');\n  return data.data.folders;\n};\n\nexport const getFolder = async (id: string): Promise<Folder> => {\n  const { data } = await api.get(`/api/workspace/folders/${id}`);\n  return data.data.folder;\n};\n\nexport const getItems = async (filters?: {\n  folderId?: string;\n  itemType?: string;\n  search?: string;\n}): Promise<FolderItem[]> => {\n  const params = new URLSearchParams();\n  if (filters?.folderId) params.append('folderId', filters.folderId);\n  if (filters?.itemType) params.append('itemType', filters.itemType);\n  if (filters?.search) params.append('search', filters.search);\n\n  const { data } = await api.get(`/api/workspace/items?${params.toString()}`);\n  return data.data.items;\n};\n\nexport const getItem = async (id: string): Promise<FolderItem> => {\n  const { data } = await api.get(`/api/workspace/items/${id}`);\n  return data.data.item;\n};\n\nexport const deleteFolder = async (id: string): Promise<void> => {\n  await api.delete(`/api/workspace/folders/${id}`);\n};\n\nexport const deleteItem = async (id: string): Promise<void> => {\n  await api.delete(`/api/workspace/items/${id}`);\n};\n\nexport const getWorkspaceStats = async (): Promise<WorkspaceStats> => {\n  const { data } = await api.get('/api/workspace/stats');\n  return data.data;\n};\n\n/* ---------------------------------------------------------\n   Caminhos Profundos\n--------------------------------------------------------- */\n\nexport const createFolderPath = async (payload: CreateFolderPathDTO) => {\n  const { data } = await api.post('/api/workspace/folder-path', payload);\n  return data;\n};\n\nexport const createSubfolder = async (payload: CreateSubfolderDTO) => {\n  const { data } = await api.post('/api/workspace/subfolder', payload);\n  return data;\n};\n\nexport const addItemToFolderPath = async (\n  payload: AddItemToFolderPathDTO\n) => {\n  const { data } = await api.post('/api/workspace/add-item-folderpath', payload);\n  return data;\n};\n\nexport const addItemToPath = async (\n  payload: AddItemToPathDTO\n) => {\n  const { data } = await api.post('/api/workspace/add-item-path', payload);\n  return data;\n};\n\nexport const searchItems = async (\n  payload: SearchItemsDTO\n) => {\n  const { data } = await api.post('/api/workspace/search', payload);\n  return data.data;\n};\n\n/* ---------------------------------------------------------\n   üìä REPORTS (NOVO)\n--------------------------------------------------------- */\n\n/**\n * Gera preview HTML do relat√≥rio\n * Usado quando a IA chama a fun√ß√£o generate_report\n */\nexport const generateReportPreview = async (\n  payload: GenerateReportDTO\n): Promise<ReportPreviewResponse> => {\n  const { data } = await api.post('/api/reports/preview', payload);\n  return data;\n};\n\n/**\n * Gera e baixa PDF do relat√≥rio a partir dos dados do workspace\n */\nexport const generateReportPDF = async (\n  payload: GenerateReportDTO\n): Promise<Blob> => {\n  const response = await api.post('/api/reports/generate-pdf', payload, {\n    responseType: 'blob'\n  });\n  return response.data;\n};\n\n/**\n * Gera PDF a partir de HTML customizado (j√° renderizado)\n * √ötil quando j√° temos o HTML do relat√≥rio e queremos gerar PDF\n */\nexport const generatePDFFromHTML = async (\n  payload: GenerateReportFromHTMLDTO\n): Promise<Blob> => {\n  const response = await api.post('/api/reports/generate-from-html', payload, {\n    responseType: 'blob'\n  });\n  return response.data;\n};\n\n/**\n * Helper: Baixa o PDF gerado\n */\nexport const downloadReportPDF = async (\n  payload: GenerateReportDTO,\n  filename?: string\n) => {\n  try {\n    const blob = await generateReportPDF(payload);\n    \n    const url = window.URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.setAttribute('download', filename || `relatorio_${Date.now()}.pdf`);\n    document.body.appendChild(link);\n    link.click();\n    link.remove();\n    window.URL.revokeObjectURL(url);\n  } catch (error) {\n    console.error('‚ùå Erro ao baixar PDF:', error);\n    throw error;\n  }\n};\n\n/**\n * Helper: Baixa PDF a partir do HTML\n */\nexport const downloadPDFFromHTML = async (\n  html: string,\n  filename?: string\n) => {\n  try {\n    const blob = await generatePDFFromHTML({ html });\n    \n    const url = window.URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.setAttribute('download', filename || `relatorio_${Date.now()}.pdf`);\n    document.body.appendChild(link);\n    link.click();\n    link.remove();\n    window.URL.revokeObjectURL(url);\n  } catch (error) {\n    console.error('‚ùå Erro ao baixar PDF:', error);\n    throw error;\n  }\n};\n\nexport default api;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 198, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Acer/Desktop/Vant/front-vant/context/apiContext.tsx"],"sourcesContent":["// src/contexts/ApiContext.tsx\n\"use client\";\n\nimport { createContext, useContext, useState, useCallback, useEffect } from \"react\";\nimport api, {\n  chatWithAI,\n  login as apiLogin,\n  register as apiRegister,\n} from \"../services/api\";\n\nimport {\n  ChatMessageDTO,\n  ChatApiResponse,\n  LoginDTO,\n  RegisterDTO,\n} from \"../types/index\";\n\ninterface ApiContextValue {\n  token: string | null;\n  setToken: (t: string | null) => void;\n  chat: (payload: ChatMessageDTO) => Promise<ChatApiResponse>;\n  login: (payload: LoginDTO) => Promise<any>;\n  register: (payload: RegisterDTO) => Promise<any>;\n}\n\nconst ApiContext = createContext<ApiContextValue | undefined>(undefined);\n\nexport function ApiProvider({ children }: { children: React.ReactNode }) {\n  const [token, setTokenState] = useState<string | null>(null);\n\n  // Carrega token salvo no localStorage ao iniciar\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      const stored = localStorage.getItem(\"token\");\n      if (stored) {\n        setTokenState(stored);\n        api.defaults.headers.common.Authorization = `Bearer ${stored}`;\n      }\n    }\n  }, []);\n\n  // Define token corretamente e joga no axios\n  const setToken = useCallback((t: string | null) => {\n    setTokenState(t);\n\n    if (typeof window === \"undefined\") return;\n\n    if (t) {\n      localStorage.setItem(\"token\", t);\n      api.defaults.headers.common.Authorization = `Bearer ${t}`;\n    } else {\n      localStorage.removeItem(\"token\");\n      delete api.defaults.headers.common.Authorization;\n    }\n  }, []);\n\n  // LOGIN\n  const login = useCallback(\n    async (payload: LoginDTO) => {\n      const res = await apiLogin(payload);\n\n      const token =\n        res?.token ||\n        res?.accessToken ||\n        res?.data?.token ||\n        res?.data?.accessToken;\n\n      if (token) {\n        setToken(token);\n      }\n\n      return res;\n    },\n    [setToken]\n  );\n\n  // REGISTER\n  const register = useCallback(async (payload: RegisterDTO) => {\n    return await apiRegister(payload);\n  }, []);\n\n  // CHAT\n  const chat = useCallback(async (payload: ChatMessageDTO) => {\n    const res = await chatWithAI(payload);\n    return res as ChatApiResponse;\n  }, []);\n\n  return (\n    <ApiContext.Provider\n      value={{ token, setToken, chat, login, register }}\n    >\n      {children}\n    </ApiContext.Provider>\n  );\n}\n\nexport const useApi = (): ApiContextValue => {\n  const ctx = useContext(ApiContext);\n  if (!ctx) throw new Error(\"useApi deve ser usado dentro de ApiProvider\");\n  return ctx;\n};\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;;;;AAG9B;AACA;;;AAHA;;;AAwBA,MAAM,2BAAa,IAAA,8KAAa,EAA8B;AAEvD,SAAS,YAAY,EAAE,QAAQ,EAAiC;;IACrE,MAAM,CAAC,OAAO,cAAc,GAAG,IAAA,yKAAQ,EAAgB;IAEvD,iDAAiD;IACjD,IAAA,0KAAS;iCAAC;YACR,wCAAmC;gBACjC,MAAM,SAAS,aAAa,OAAO,CAAC;gBACpC,IAAI,QAAQ;oBACV,cAAc;oBACd,6HAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,QAAQ;gBAChE;YACF;QACF;gCAAG,EAAE;IAEL,4CAA4C;IAC5C,MAAM,WAAW,IAAA,4KAAW;6CAAC,CAAC;YAC5B,cAAc;YAEd;;YAEA,IAAI,GAAG;gBACL,aAAa,OAAO,CAAC,SAAS;gBAC9B,6HAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,GAAG;YAC3D,OAAO;gBACL,aAAa,UAAU,CAAC;gBACxB,OAAO,6HAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,aAAa;YAClD;QACF;4CAAG,EAAE;IAEL,QAAQ;IACR,MAAM,QAAQ,IAAA,4KAAW;0CACvB,OAAO;YACL,MAAM,MAAM,MAAM,IAAA,2HAAQ,EAAC;YAE3B,MAAM,QACJ,KAAK,SACL,KAAK,eACL,KAAK,MAAM,SACX,KAAK,MAAM;YAEb,IAAI,OAAO;gBACT,SAAS;YACX;YAEA,OAAO;QACT;yCACA;QAAC;KAAS;IAGZ,WAAW;IACX,MAAM,WAAW,IAAA,4KAAW;6CAAC,OAAO;YAClC,OAAO,MAAM,IAAA,8HAAW,EAAC;QAC3B;4CAAG,EAAE;IAEL,OAAO;IACP,MAAM,OAAO,IAAA,4KAAW;yCAAC,OAAO;YAC9B,MAAM,MAAM,MAAM,IAAA,gIAAU,EAAC;YAC7B,OAAO;QACT;wCAAG,EAAE;IAEL,qBACE,6LAAC,WAAW,QAAQ;QAClB,OAAO;YAAE;YAAO;YAAU;YAAM;YAAO;QAAS;kBAE/C;;;;;;AAGP;GAnEgB;KAAA;AAqET,MAAM,SAAS;;IACpB,MAAM,MAAM,IAAA,2KAAU,EAAC;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT;IAJa"}}]
}